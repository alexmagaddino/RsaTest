package it.alex

import java.security.MessageDigest
import java.security.NoSuchAlgorithmException
import java.util.*


const val ciao = "ciao"

const val pvt = "MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDRRrqM1DSs69HBLVKWVPKfs0UHOdFqk9HV80cWBUkpb4oFu/H88NVR/MoApoZUXaVea9WgnLI+dvOrEaf7KqqGeUXoh/GVgoaKlbqY2O6AVQDxc7oI5voaf5Ycf0KTzEA3rDmCFIHyuKjb+ZRE66caUwRKY5NzSkHA4oZysU6gwv/fN3gKb7zrlc90NILMtBLIAAycoodjapFuC8y1MuLXjWPLlWgAAwznTk9C1FYs+QHcMb4R+64cPL4yfVgx4YOnINOdKQaN3d8NstSWI6NyOLF+PNZoiwbrNfAWGADSpb+LIUn5Oalbwg5aQJ6YF83M7s2kevUGRZ7bsanvKuRpAgMBAAECggEBAMaFesfHMeTrm0HOVa7IDJSUQaIWJeMdMIvtyHxKLVoCNgM0g9y3NRUeYR122qzDXPESCEfg/XEl9AZOrHQlyDfiaP+pnfF/LVPfr2/5MV5JxKhHaK2zNoPWjjagPi7oLe7iEHemLpNqurxZqF4s0Yq2P7a1eRV/1po8COBZ9EWonkRjLHjTjFqPx2oFCYd90VsgrUSJccKGM76v2b9EqTx2gRVmPdW4GqXM3bW0wd9DoF9tEVBgLH7K4yfpuqvGvfPXOT5F4uzdlsNj1eBMQkd7NT9SjWQyP7fc5QiEy460v4HYJk0oYDQ1/civzIGx/e87sEyQvrY5jR9T0nOSkYECgYEA7JKnNsBukVUmwzX30puOF1u2NtoiTSJ+sV8pw3YDKwn54DLobz/PrMVTVE62G6pECdCq9qNobrxsWLHyKVWCqYvYAQUjyeOTy9khBeVLdZ/nTfm9w5MQ402gjoBrqyv/08cdToykMsdUT3AUmwSFoyLg60MgIhmvbk7X+wnzHtkCgYEA4nY74Ks4yN3qDQwCoyLoVcWlDAPfTWn0m6U0h86h9uht9ReAuINdTCMWAeoY971/uRmZbf3HNv6i5ifWnWF14k2AGpZo7JZS+JRmnVacQRgOG+cPoWGO5KqKLEYY5Wn3g7KwcYzqASIleFMRCqHg19AkMk5PSvy6NwUPzOI9mBECgYBZLdts71N+46uOEQ0PzmXc9kyVFtuxWhyKPoZe0WDWW5dfZbFrJpHh3izQbi+F9ERbstaPzP+0JsFtGf9gh4SO51GQ6OAZ3fk78ejZ8RrmB1ZJdaiMTicimIO61DxCNX7l1Xx9vNS086EbpPOPkD/URHSnGxHE6QvRuFUApDqK2QKBgGlJ21D7im0pb9YdDWTXp/mo6LGLY1jUuFtdFe1GTttC+UyIXtpqiQgLEAJX2r/kJOvkUQdohCS3gvlK8Gc/ltVefv7di27j/TOBm6vvRrqk+npSlVvMxejeuVsYRB71g5SBkbNZdrqMK6ujwzqURLtSFGInMoqEsfc+rTfuwABhAoGBAOCNUej7V6X289phJ2DfJP+wwJr92IWGOG+e9s22GRN6aljW7N+6Vx3LPDB5AqFOsXhadDArBg+6CdhcXEZinzIz561CF4FTAAi/OEal54H99J4q+VBdwlOJzc9UqB+0WVDGjVyAAIbpdbj0QiHJpfCid3271NHg6sYXzc9pX5W4"

const val pub = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0Ua6jNQ0rOvRwS1SllTyn7NFBznRapPR1fNHFgVJKW+KBbvx/PDVUfzKAKaGVF2lXmvVoJyyPnbzqxGn+yqqhnlF6IfxlYKGipW6mNjugFUA8XO6COb6Gn+WHH9Ck8xAN6w5ghSB8rio2/mUROunGlMESmOTc0pBwOKGcrFOoML/3zd4Cm+865XPdDSCzLQSyAAMnKKHY2qRbgvMtTLi141jy5VoAAMM505PQtRWLPkB3DG+EfuuHDy+Mn1YMeGDpyDTnSkGjd3fDbLUliOjcjixfjzWaIsG6zXwFhgA0qW/iyFJ+TmpW8IOWkCemBfNzO7NpHr1BkWe27Gp7yrkaQIDAQAB"

fun main() {

//    val encC = RSAUtils.encryptInBase64WithPublicBase64Key(pub, ciao).print()
//
//    RsaUtil.decrypt(encC, RsaUtil.loadPrivateKey(pvt)).print() isEqual ciao

    SHA256(ciao).print()
}


@Throws(NoSuchAlgorithmException::class)
fun SHA256(text: String): String {

    val md = MessageDigest.getInstance("SHA-256")

    md.update(text.toByteArray())
    val digest = md.digest()

    return Base64.getEncoder().encodeToString(digest)
}
